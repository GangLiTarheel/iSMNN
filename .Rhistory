library(devtools)
library(roxygen2)
load("C:/Users/yangy/Downloads/iSMNN/data_iSMNN.rda")
setwd("C:/Users/yangy/OneDrive/Documents/")
create("iSMNN")
setwd("iSMNN")
usethis::use_data(data_iSMNN)
load("C:/Users/yangy/Downloads/iSMNN/cardiac_sample1_3/sample1_3.combined_uncorrected.RData")
load("C:/Users/yangy/Downloads/iSMNN/cardiac_sample1_3/sample1_3.combined_SMNN2.RData")
load("C:/Users/yangy/Downloads/iSMNN/cardiac_sample1_3/sample1_3.MNN_umap.RData")
kBET_uncorrect(uncorrected@reductions$umap@cell.embeddings[-which(MNN.umap$layout[,2]<(-20) | MNN.umap$layout[,1]>20),], c(rep(1, 945), rep(2, 5964)))
kBET_uncorrect = kBET(uncorrected@reductions$umap@cell.embeddings[-which(MNN.umap$layout[,2]<(-20) | MNN.umap$layout[,1]>20),], c(rep(1, 945), rep(2, 5964)))
library(kBET)
kBET_uncorrect = kBET(uncorrected@reductions$umap@cell.embeddings[-which(MNN.umap$layout[,2]<(-20) | MNN.umap$layout[,1]>20),], c(rep(1, 945), rep(2, 5964)))
kBET_uncorrect$average.pval
kBET_iSMNN = kBET(sample1_3.combined_SMNN2@reductions$umap@cell.embeddings[-which(MNN.umap$layout[,2]<(-20) | MNN.umap$layout[,1]>20),], c(rep(1, 945), rep(2, 5964)))
kBET_iSMNN$average.pval
head(sample1_3.combined_SMNN2@reductions$umap@cell.embeddings[-which(MNN.umap$layout[,2]<(-20) | MNN.umap$layout[,1]>20),])
document()
document()
document()
document()
